. The Initiator obtains from Facebook IKR
pk, SPKR
pk and OTPKR
pk for
an one-time pre-key keypair generated by the Responder device.
2. Facebook deletes OTPKR
pk from the Responderâ€™s list of available
one-time pre-keys, so long as it is not the last-resort.
3. The Initiator generates a fresh ephemeral keypair (EKI
pk, EKI
sk).
4. The Initiator now computes the first root key RK as follows:
a = ECDH(IKI
sk, SPKR
pk), b = ECDH(EKI
sk, IKR
pk)
c = ECDH(EKI
sk, SPKR
pk), d = ECDH(EKI
sk, OTPKR
pk)
RK = HKDF(a||b||c||d)
Using the RK the Initiator can calculate the first CK and MK (as
described next) and use those to start sending messages.
5. The Initiator sends the first encrypted message to the Responder,
including the fresh EKI
pk it generated previously.# Built application files
*.apk
*.aar
*.ap_
*.aab

# Files for the ART/Dalvik VM
*.dex

# Java class files
*.class

# Generated files
bin/
gen/
out/
#  Uncomment the following line in case you need and you don't have the release build type files in your app
# release/

# Gradle files
.gradle/
build/

# Local configuration file (sdk path, etc)
local.properties

# Proguard folder generated by Eclipse
proguard/

# Log Files
*.log

# Android Studio Navigation editor temp files
.navigation/

# Android Studio captures folder
captures/

# IntelliJ
*.iml
.idea/workspace.xml
.idea/tasks.xml
.idea/gradle.xml
.idea/assetWizardSettings.xml
.idea/dictionaries
.idea/libraries
# Android Studio 3 in .gitignore file.
.idea/caches
.idea/modules.xml
# Comment next line if keeping position of elements in Navigation Editor is relevant for you
.idea/navEditor.xml

# Keystore files
# Uncomment the following lines if you do not want to check your keystore files in.
#*.jks
#*.keystore

# External native build folder generated in Android Studio 2.2 and later
.externalNativeBuild
.cxx/

# Google Services (e.g. APIs or Firebase)
# google-services.json

# Freeline
freeline.py
freeline/
freeline_project_description.json

# fastlane
fastlane/report.xml
fastlane/Preview.html
fastlane/screenshots
fastlane/test_output
fastlane/readme.md

# Version control
vcs.xml

# lint
lint/intermediates/
lint/generated/
lint/outputs/
lint/tmp/
# lint/reports/
